2023-11-16 18:10:41,284 [trainer.py] => config: ./exps/ease_inr_in21k.json
2023-11-16 18:10:41,284 [trainer.py] => prefix:  
2023-11-16 18:10:41,284 [trainer.py] => dataset: imagenetr
2023-11-16 18:10:41,284 [trainer.py] => memory_size: 0
2023-11-16 18:10:41,284 [trainer.py] => memory_per_class: 0
2023-11-16 18:10:41,284 [trainer.py] => fixed_memory: False
2023-11-16 18:10:41,284 [trainer.py] => shuffle: True
2023-11-16 18:10:41,284 [trainer.py] => init_cls: 20
2023-11-16 18:10:41,284 [trainer.py] => increment: 20
2023-11-16 18:10:41,284 [trainer.py] => model_name: ease
2023-11-16 18:10:41,284 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2023-11-16 18:10:41,284 [trainer.py] => device: [device(type='cuda', index=0)]
2023-11-16 18:10:41,284 [trainer.py] => seed: 1993
2023-11-16 18:10:41,284 [trainer.py] => init_epochs: 20
2023-11-16 18:10:41,284 [trainer.py] => init_lr: 0.05
2023-11-16 18:10:41,284 [trainer.py] => later_epochs: 20
2023-11-16 18:10:41,284 [trainer.py] => later_lr: 0.05
2023-11-16 18:10:41,284 [trainer.py] => batch_size: 16
2023-11-16 18:10:41,284 [trainer.py] => weight_decay: 0.005
2023-11-16 18:10:41,284 [trainer.py] => min_lr: 0
2023-11-16 18:10:41,284 [trainer.py] => optimizer: sgd
2023-11-16 18:10:41,284 [trainer.py] => scheduler: cosine
2023-11-16 18:10:41,284 [trainer.py] => pretrained: True
2023-11-16 18:10:41,284 [trainer.py] => vpt_type: Deep
2023-11-16 18:10:41,284 [trainer.py] => prompt_token_num: 5
2023-11-16 18:10:41,284 [trainer.py] => ffn_num: 64
2023-11-16 18:10:41,284 [trainer.py] => solve_method: sim
2023-11-16 18:10:41,284 [trainer.py] => use_diagonal: False
2023-11-16 18:10:41,284 [trainer.py] => recalc_sim: True
2023-11-16 18:10:41,284 [trainer.py] => alpha: 0.1
2023-11-16 18:10:41,284 [trainer.py] => use_init_ptm: False
2023-11-16 18:10:41,284 [trainer.py] => beta: 0
2023-11-16 18:10:41,284 [trainer.py] => use_old_data: False
2023-11-16 18:10:41,285 [trainer.py] => use_reweight: True
2023-11-16 18:10:41,285 [trainer.py] => moni_adam: False
2023-11-16 18:10:41,285 [trainer.py] => adapter_num: -1
2023-11-16 18:10:41,350 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2023-11-16 18:10:44,550 [trainer.py] => All params: 86988288
2023-11-16 18:10:44,551 [trainer.py] => Trainable params: 1189632
2023-11-16 18:10:44,558 [ease.py] => Learning on 0-20
2023-11-16 18:13:37,781 [ease.py] => Task 0, Epoch 20/20 => Loss 0.442, Train_accy 88.69
2023-11-16 18:13:44,879 [ease.py] => Task correct: 100.0
2023-11-16 18:13:44,880 [ease.py] => Task acc: 93.32365747460086
2023-11-16 18:13:44,908 [trainer.py] => No NME accuracy.
2023-11-16 18:13:44,908 [trainer.py] => CNN: {'total': 93.32, '00-19': 93.32, 'old': 0, 'new': 93.32}
2023-11-16 18:13:44,908 [trainer.py] => CNN top1 curve: [93.32]
2023-11-16 18:13:44,908 [trainer.py] => CNN top5 curve: [98.26]

2023-11-16 18:13:44,908 [trainer.py] => Average Accuracy (CNN): 93.32 

2023-11-16 18:13:44,909 [trainer.py] => All params: 87019010
2023-11-16 18:13:44,909 [trainer.py] => Trainable params: 1189632
2023-11-16 18:13:44,911 [ease.py] => Learning on 20-40
2023-11-16 18:16:21,733 [ease.py] => Task 1, Epoch 20/20 => Loss 0.478, Train_accy 87.20
2023-11-16 18:16:35,423 [ease.py] => Task correct: 92.42997728993187
2023-11-16 18:16:35,424 [ease.py] => Task acc: 92.58137774413323
2023-11-16 18:16:35,452 [trainer.py] => No NME accuracy.
2023-11-16 18:16:35,452 [trainer.py] => CNN: {'total': 87.51, '00-19': 87.23, '20-39': 87.82, 'old': 87.23, 'new': 87.82}
2023-11-16 18:16:35,452 [trainer.py] => CNN top1 curve: [93.32, 87.51]
2023-11-16 18:16:35,452 [trainer.py] => CNN top5 curve: [98.26, 97.8]

2023-11-16 18:16:35,452 [trainer.py] => Average Accuracy (CNN): 90.41499999999999 

2023-11-16 18:16:35,453 [trainer.py] => All params: 87065090
2023-11-16 18:16:35,453 [trainer.py] => Trainable params: 1189632
2023-11-16 18:16:35,455 [ease.py] => Learning on 40-60
2023-11-16 18:19:02,580 [ease.py] => Task 2, Epoch 20/20 => Loss 0.489, Train_accy 87.54
2023-11-16 18:19:26,261 [ease.py] => Task correct: 88.73897249610793
2023-11-16 18:19:26,261 [ease.py] => Task acc: 92.11209133367929
2023-11-16 18:19:26,287 [trainer.py] => No NME accuracy.
2023-11-16 18:19:26,288 [trainer.py] => CNN: {'total': 84.85, '00-19': 85.49, '20-39': 84.65, '40-59': 84.32, 'old': 85.09, 'new': 84.32}
2023-11-16 18:19:26,288 [trainer.py] => CNN top1 curve: [93.32, 87.51, 84.85]
2023-11-16 18:19:26,288 [trainer.py] => CNN top5 curve: [98.26, 97.8, 96.26]

2023-11-16 18:19:26,288 [trainer.py] => Average Accuracy (CNN): 88.55999999999999 

2023-11-16 18:19:26,288 [trainer.py] => All params: 87141890
2023-11-16 18:19:26,289 [trainer.py] => Trainable params: 1189632
2023-11-16 18:19:26,294 [ease.py] => Learning on 60-80
2023-11-16 18:21:47,779 [ease.py] => Task 3, Epoch 20/20 => Loss 0.494, Train_accy 87.79
2023-11-16 18:22:20,185 [ease.py] => Task correct: 86.38911128903122
2023-11-16 18:22:20,186 [ease.py] => Task acc: 92.07365892714171
2023-11-16 18:22:20,217 [trainer.py] => No NME accuracy.
2023-11-16 18:22:20,218 [trainer.py] => CNN: {'total': 82.95, '00-19': 83.45, '20-39': 83.54, '40-59': 82.34, '60-79': 82.31, 'old': 83.13, 'new': 82.31}
2023-11-16 18:22:20,218 [trainer.py] => CNN top1 curve: [93.32, 87.51, 84.85, 82.95]
2023-11-16 18:22:20,218 [trainer.py] => CNN top5 curve: [98.26, 97.8, 96.26, 95.32]

2023-11-16 18:22:20,218 [trainer.py] => Average Accuracy (CNN): 87.15749999999998 

2023-11-16 18:22:20,218 [trainer.py] => All params: 87249410
2023-11-16 18:22:20,219 [trainer.py] => Trainable params: 1189632
2023-11-16 18:22:20,224 [ease.py] => Learning on 80-100
2023-11-16 18:24:33,142 [ease.py] => Task 4, Epoch 20/20 => Loss 0.477, Train_accy 87.54
2023-11-16 18:25:13,747 [ease.py] => Task correct: 83.45058626465662
2023-11-16 18:25:13,747 [ease.py] => Task acc: 91.52428810720268
2023-11-16 18:25:13,795 [trainer.py] => No NME accuracy.
2023-11-16 18:25:13,795 [trainer.py] => CNN: {'total': 80.1, '00-19': 81.13, '20-39': 82.28, '40-59': 80.03, '60-79': 79.16, '80-99': 77.0, 'old': 80.7, 'new': 77.0}
2023-11-16 18:25:13,795 [trainer.py] => CNN top1 curve: [93.32, 87.51, 84.85, 82.95, 80.1]
2023-11-16 18:25:13,795 [trainer.py] => CNN top5 curve: [98.26, 97.8, 96.26, 95.32, 93.9]

2023-11-16 18:25:13,795 [trainer.py] => Average Accuracy (CNN): 85.74599999999998 

2023-11-16 18:25:13,796 [trainer.py] => All params: 87387650
2023-11-16 18:25:13,797 [trainer.py] => Trainable params: 1189632
2023-11-16 18:25:13,804 [ease.py] => Learning on 100-120
2023-11-16 18:27:56,312 [ease.py] => Task 5, Epoch 20/20 => Loss 0.457, Train_accy 88.11
2023-11-16 18:28:58,312 [ease.py] => Task correct: 82.03017832647463
2023-11-16 18:28:58,313 [ease.py] => Task acc: 91.65980795610425
2023-11-16 18:28:58,337 [trainer.py] => No NME accuracy.
2023-11-16 18:28:58,337 [trainer.py] => CNN: {'total': 79.09, '00-19': 77.5, '20-39': 81.49, '40-59': 78.55, '60-79': 76.18, '80-99': 75.36, '100-119': 84.24, 'old': 77.96, 'new': 84.24}
2023-11-16 18:28:58,337 [trainer.py] => CNN top1 curve: [93.32, 87.51, 84.85, 82.95, 80.1, 79.09]
2023-11-16 18:28:58,337 [trainer.py] => CNN top5 curve: [98.26, 97.8, 96.26, 95.32, 93.9, 93.61]

2023-11-16 18:28:58,337 [trainer.py] => Average Accuracy (CNN): 84.63666666666666 

2023-11-16 18:28:58,337 [trainer.py] => All params: 87556610
2023-11-16 18:28:58,338 [trainer.py] => Trainable params: 1189632
2023-11-16 18:28:58,344 [ease.py] => Learning on 120-140
2023-11-16 18:31:08,760 [ease.py] => Task 6, Epoch 20/20 => Loss 0.450, Train_accy 88.37
2023-11-16 18:32:17,036 [ease.py] => Task correct: 80.96820123398196
2023-11-16 18:32:17,036 [ease.py] => Task acc: 91.50450878025629
2023-11-16 18:32:17,067 [trainer.py] => No NME accuracy.
2023-11-16 18:32:17,067 [trainer.py] => CNN: {'total': 78.43, '00-19': 76.78, '20-39': 80.38, '40-59': 77.39, '60-79': 75.31, '80-99': 74.13, '100-119': 83.48, '120-139': 80.32, 'old': 78.13, 'new': 80.32}
2023-11-16 18:32:17,067 [trainer.py] => CNN top1 curve: [93.32, 87.51, 84.85, 82.95, 80.1, 79.09, 78.43]
2023-11-16 18:32:17,067 [trainer.py] => CNN top5 curve: [98.26, 97.8, 96.26, 95.32, 93.9, 93.61, 92.86]

2023-11-16 18:32:17,067 [trainer.py] => Average Accuracy (CNN): 83.75 

2023-11-16 18:32:17,068 [trainer.py] => All params: 87756290
2023-11-16 18:32:17,068 [trainer.py] => Trainable params: 1189632
2023-11-16 18:32:17,077 [ease.py] => Learning on 140-160
2023-11-16 18:35:09,677 [ease.py] => Task 7, Epoch 20/20 => Loss 0.446, Train_accy 89.06
2023-11-16 18:36:50,727 [ease.py] => Task correct: 80.23467529840178
2023-11-16 18:36:50,727 [ease.py] => Task acc: 91.68521141007486
2023-11-16 18:36:50,765 [trainer.py] => No NME accuracy.
2023-11-16 18:36:50,765 [trainer.py] => CNN: {'total': 78.01, '00-19': 75.04, '20-39': 78.96, '40-59': 77.06, '60-79': 74.08, '80-99': 73.1, '100-119': 81.82, '120-139': 79.44, '140-159': 82.58, 'old': 77.22, 'new': 82.58}
2023-11-16 18:36:50,765 [trainer.py] => CNN top1 curve: [93.32, 87.51, 84.85, 82.95, 80.1, 79.09, 78.43, 78.01]
2023-11-16 18:36:50,765 [trainer.py] => CNN top5 curve: [98.26, 97.8, 96.26, 95.32, 93.9, 93.61, 92.86, 92.35]

2023-11-16 18:36:50,765 [trainer.py] => Average Accuracy (CNN): 83.0325 

2023-11-16 18:36:50,766 [trainer.py] => All params: 87986690
2023-11-16 18:36:50,767 [trainer.py] => Trainable params: 1189632
2023-11-16 18:36:50,781 [ease.py] => Learning on 160-180
2023-11-16 18:38:53,662 [ease.py] => Task 8, Epoch 20/20 => Loss 0.517, Train_accy 86.70
2023-11-16 18:40:41,958 [ease.py] => Task correct: 78.95222283711492
2023-11-16 18:40:41,959 [ease.py] => Task acc: 91.51448072311382
2023-11-16 18:40:41,986 [trainer.py] => No NME accuracy.
2023-11-16 18:40:41,986 [trainer.py] => CNN: {'total': 76.94, '00-19': 74.89, '20-39': 78.32, '40-59': 75.91, '60-79': 73.2, '80-99': 71.25, '100-119': 81.06, '120-139': 78.38, '140-159': 81.34, '160-179': 75.52, 'old': 77.08, 'new': 75.52}
2023-11-16 18:40:41,986 [trainer.py] => CNN top1 curve: [93.32, 87.51, 84.85, 82.95, 80.1, 79.09, 78.43, 78.01, 76.94]
2023-11-16 18:40:41,986 [trainer.py] => CNN top5 curve: [98.26, 97.8, 96.26, 95.32, 93.9, 93.61, 92.86, 92.35, 91.55]

2023-11-16 18:40:41,986 [trainer.py] => Average Accuracy (CNN): 82.35555555555555 

2023-11-16 18:40:41,987 [trainer.py] => All params: 88247810
2023-11-16 18:40:41,987 [trainer.py] => Trainable params: 1189632
2023-11-16 18:40:41,998 [ease.py] => Learning on 180-200
2023-11-16 18:43:02,479 [ease.py] => Task 9, Epoch 20/20 => Loss 0.434, Train_accy 89.03
2023-11-16 18:45:08,029 [ease.py] => Task correct: 77.98333333333333
2023-11-16 18:45:08,030 [ease.py] => Task acc: 91.63333333333334
2023-11-16 18:45:08,072 [trainer.py] => No NME accuracy.
2023-11-16 18:45:08,072 [trainer.py] => CNN: {'total': 76.17, '00-19': 73.88, '20-39': 76.74, '40-59': 73.93, '60-79': 71.98, '80-99': 69.61, '100-119': 80.45, '120-139': 77.33, '140-159': 80.8, '160-179': 74.48, '180-199': 79.79, 'old': 75.78, 'new': 79.79}
2023-11-16 18:45:08,072 [trainer.py] => CNN top1 curve: [93.32, 87.51, 84.85, 82.95, 80.1, 79.09, 78.43, 78.01, 76.94, 76.17]
2023-11-16 18:45:08,072 [trainer.py] => CNN top5 curve: [98.26, 97.8, 96.26, 95.32, 93.9, 93.61, 92.86, 92.35, 91.55, 91.33]

2023-11-16 18:45:08,072 [trainer.py] => Average Accuracy (CNN): 81.737 

