2023-11-16 17:11:44,168 [trainer.py] => config: ./exps/ease_inr.json
2023-11-16 17:11:44,168 [trainer.py] => prefix:  
2023-11-16 17:11:44,168 [trainer.py] => dataset: imagenetr
2023-11-16 17:11:44,168 [trainer.py] => memory_size: 0
2023-11-16 17:11:44,168 [trainer.py] => memory_per_class: 0
2023-11-16 17:11:44,168 [trainer.py] => fixed_memory: False
2023-11-16 17:11:44,168 [trainer.py] => shuffle: True
2023-11-16 17:11:44,168 [trainer.py] => init_cls: 20
2023-11-16 17:11:44,168 [trainer.py] => increment: 20
2023-11-16 17:11:44,168 [trainer.py] => model_name: ease
2023-11-16 17:11:44,168 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2023-11-16 17:11:44,169 [trainer.py] => device: [device(type='cuda', index=0)]
2023-11-16 17:11:44,169 [trainer.py] => seed: 1993
2023-11-16 17:11:44,169 [trainer.py] => init_epochs: 20
2023-11-16 17:11:44,169 [trainer.py] => init_lr: 0.05
2023-11-16 17:11:44,169 [trainer.py] => later_epochs: 20
2023-11-16 17:11:44,169 [trainer.py] => later_lr: 0.05
2023-11-16 17:11:44,169 [trainer.py] => batch_size: 16
2023-11-16 17:11:44,169 [trainer.py] => weight_decay: 0.005
2023-11-16 17:11:44,169 [trainer.py] => min_lr: 0
2023-11-16 17:11:44,169 [trainer.py] => optimizer: sgd
2023-11-16 17:11:44,169 [trainer.py] => scheduler: cosine
2023-11-16 17:11:44,169 [trainer.py] => pretrained: True
2023-11-16 17:11:44,169 [trainer.py] => vpt_type: Deep
2023-11-16 17:11:44,169 [trainer.py] => prompt_token_num: 5
2023-11-16 17:11:44,169 [trainer.py] => ffn_num: 64
2023-11-16 17:11:44,169 [trainer.py] => solve_method: sim
2023-11-16 17:11:44,169 [trainer.py] => use_diagonal: False
2023-11-16 17:11:44,169 [trainer.py] => recalc_sim: True
2023-11-16 17:11:44,169 [trainer.py] => alpha: 0.1
2023-11-16 17:11:44,169 [trainer.py] => use_init_ptm: False
2023-11-16 17:11:44,169 [trainer.py] => beta: 0
2023-11-16 17:11:44,169 [trainer.py] => use_old_data: False
2023-11-16 17:11:44,169 [trainer.py] => use_reweight: True
2023-11-16 17:11:44,169 [trainer.py] => moni_adam: False
2023-11-16 17:11:44,169 [trainer.py] => adapter_num: -1
2023-11-16 17:11:44,236 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2023-11-16 17:11:48,324 [trainer.py] => All params: 86988288
2023-11-16 17:11:48,324 [trainer.py] => Trainable params: 1189632
2023-11-16 17:11:48,334 [ease.py] => Learning on 0-20
2023-11-16 17:17:06,805 [ease.py] => Task 0, Epoch 20/20 => Loss 0.445, Train_accy 88.48
2023-11-16 17:17:17,513 [ease.py] => Task correct: 100.0
2023-11-16 17:17:17,513 [ease.py] => Task acc: 92.59796806966618
2023-11-16 17:17:17,578 [trainer.py] => No NME accuracy.
2023-11-16 17:17:17,578 [trainer.py] => CNN: {'total': 92.6, '00-19': 92.6, 'old': 0, 'new': 92.6}
2023-11-16 17:17:17,578 [trainer.py] => CNN top1 curve: [92.6]
2023-11-16 17:17:17,578 [trainer.py] => CNN top5 curve: [98.55]

2023-11-16 17:17:17,578 [trainer.py] => Average Accuracy (CNN): 92.6 

2023-11-16 17:17:17,579 [trainer.py] => All params: 87019010
2023-11-16 17:17:17,580 [trainer.py] => Trainable params: 1189632
2023-11-16 17:17:17,582 [ease.py] => Learning on 20-40
2023-11-16 17:22:22,746 [ease.py] => Task 1, Epoch 20/20 => Loss 0.482, Train_accy 87.20
2023-11-16 17:22:48,647 [ease.py] => Task correct: 92.50567751703255
2023-11-16 17:22:48,647 [ease.py] => Task acc: 92.12717638152914
2023-11-16 17:22:48,713 [trainer.py] => No NME accuracy.
2023-11-16 17:22:48,713 [trainer.py] => CNN: {'total': 87.66, '00-19': 86.94, '20-39': 88.45, 'old': 86.94, 'new': 88.45}
2023-11-16 17:22:48,713 [trainer.py] => CNN top1 curve: [92.6, 87.66]
2023-11-16 17:22:48,714 [trainer.py] => CNN top5 curve: [98.55, 97.05]

2023-11-16 17:22:48,714 [trainer.py] => Average Accuracy (CNN): 90.13 

2023-11-16 17:22:48,714 [trainer.py] => All params: 87065090
2023-11-16 17:22:48,715 [trainer.py] => Trainable params: 1189632
2023-11-16 17:22:48,722 [ease.py] => Learning on 40-60
2023-11-16 17:27:27,942 [ease.py] => Task 2, Epoch 20/20 => Loss 0.484, Train_accy 87.96
2023-11-16 17:28:07,423 [ease.py] => Task correct: 89.93253762324858
2023-11-16 17:28:07,423 [ease.py] => Task acc: 91.90451478982875
2023-11-16 17:28:07,474 [trainer.py] => No NME accuracy.
2023-11-16 17:28:07,474 [trainer.py] => CNN: {'total': 85.63, '00-19': 85.63, '20-39': 85.76, '40-59': 85.48, 'old': 85.69, 'new': 85.48}
2023-11-16 17:28:07,474 [trainer.py] => CNN top1 curve: [92.6, 87.66, 85.63]
2023-11-16 17:28:07,474 [trainer.py] => CNN top5 curve: [98.55, 97.05, 95.95]

2023-11-16 17:28:07,474 [trainer.py] => Average Accuracy (CNN): 88.63 

2023-11-16 17:28:07,475 [trainer.py] => All params: 87141890
2023-11-16 17:28:07,475 [trainer.py] => Trainable params: 1189632
2023-11-16 17:28:07,479 [ease.py] => Learning on 60-80
2023-11-16 17:32:19,684 [ease.py] => Task 3, Epoch 20/20 => Loss 0.491, Train_accy 87.53
2023-11-16 17:33:20,359 [ease.py] => Task correct: 87.34987990392314
2023-11-16 17:33:20,360 [ease.py] => Task acc: 91.99359487590073
2023-11-16 17:33:20,424 [trainer.py] => No NME accuracy.
2023-11-16 17:33:20,424 [trainer.py] => CNN: {'total': 83.59, '00-19': 84.03, '20-39': 83.86, '40-59': 82.84, '60-79': 83.54, 'old': 83.6, 'new': 83.54}
2023-11-16 17:33:20,425 [trainer.py] => CNN top1 curve: [92.6, 87.66, 85.63, 83.59]
2023-11-16 17:33:20,425 [trainer.py] => CNN top5 curve: [98.55, 97.05, 95.95, 95.0]

2023-11-16 17:33:20,425 [trainer.py] => Average Accuracy (CNN): 87.37 

2023-11-16 17:33:20,425 [trainer.py] => All params: 87249410
2023-11-16 17:33:20,426 [trainer.py] => Trainable params: 1189632
2023-11-16 17:33:20,435 [ease.py] => Learning on 80-100
2023-11-16 17:37:51,870 [ease.py] => Task 4, Epoch 20/20 => Loss 0.489, Train_accy 87.08
2023-11-16 17:39:12,053 [ease.py] => Task correct: 85.09212730318258
2023-11-16 17:39:12,054 [ease.py] => Task acc: 91.69179229480737
2023-11-16 17:39:12,124 [trainer.py] => No NME accuracy.
2023-11-16 17:39:12,124 [trainer.py] => CNN: {'total': 81.51, '00-19': 82.87, '20-39': 82.59, '40-59': 80.53, '60-79': 81.61, '80-99': 79.26, 'old': 81.95, 'new': 79.26}
2023-11-16 17:39:12,124 [trainer.py] => CNN top1 curve: [92.6, 87.66, 85.63, 83.59, 81.51]
2023-11-16 17:39:12,124 [trainer.py] => CNN top5 curve: [98.55, 97.05, 95.95, 95.0, 94.14]

2023-11-16 17:39:12,124 [trainer.py] => Average Accuracy (CNN): 86.19800000000001 

2023-11-16 17:39:12,125 [trainer.py] => All params: 87387650
2023-11-16 17:39:12,125 [trainer.py] => Trainable params: 1189632
2023-11-16 17:39:12,135 [ease.py] => Learning on 100-120
2023-11-16 17:42:16,059 [ease.py] => Task 5, Epoch 20/20 => Loss 0.464, Train_accy 87.54
2023-11-16 17:43:19,499 [ease.py] => Task correct: 83.75857338820302
2023-11-16 17:43:19,500 [ease.py] => Task acc: 91.90672153635117
2023-11-16 17:43:19,543 [trainer.py] => No NME accuracy.
2023-11-16 17:43:19,543 [trainer.py] => CNN: {'total': 80.74, '00-19': 80.84, '20-39': 81.33, '40-59': 79.37, '60-79': 78.11, '80-99': 78.64, '100-119': 85.15, 'old': 79.77, 'new': 85.15}
2023-11-16 17:43:19,544 [trainer.py] => CNN top1 curve: [92.6, 87.66, 85.63, 83.59, 81.51, 80.74]
2023-11-16 17:43:19,544 [trainer.py] => CNN top5 curve: [98.55, 97.05, 95.95, 95.0, 94.14, 93.94]

2023-11-16 17:43:19,544 [trainer.py] => Average Accuracy (CNN): 85.28833333333334 

2023-11-16 17:43:19,544 [trainer.py] => All params: 87556610
2023-11-16 17:43:19,545 [trainer.py] => Trainable params: 1189632
2023-11-16 17:43:19,552 [ease.py] => Learning on 120-140
2023-11-16 17:45:33,956 [ease.py] => Task 6, Epoch 20/20 => Loss 0.441, Train_accy 88.61
2023-11-16 17:46:43,637 [ease.py] => Task correct: 82.41575700047461
2023-11-16 17:46:43,638 [ease.py] => Task acc: 91.67062173706692
2023-11-16 17:46:43,677 [trainer.py] => No NME accuracy.
2023-11-16 17:46:43,677 [trainer.py] => CNN: {'total': 79.83, '00-19': 80.12, '20-39': 80.54, '40-59': 78.55, '60-79': 77.58, '80-99': 77.21, '100-119': 84.39, '120-139': 79.26, 'old': 79.92, 'new': 79.26}
2023-11-16 17:46:43,677 [trainer.py] => CNN top1 curve: [92.6, 87.66, 85.63, 83.59, 81.51, 80.74, 79.83]
2023-11-16 17:46:43,677 [trainer.py] => CNN top5 curve: [98.55, 97.05, 95.95, 95.0, 94.14, 93.94, 93.07]

2023-11-16 17:46:43,677 [trainer.py] => Average Accuracy (CNN): 84.50857142857144 

2023-11-16 17:46:43,678 [trainer.py] => All params: 87756290
2023-11-16 17:46:43,678 [trainer.py] => Trainable params: 1189632
2023-11-16 17:46:43,690 [ease.py] => Learning on 140-160
2023-11-16 17:49:39,546 [ease.py] => Task 7, Epoch 20/20 => Loss 0.432, Train_accy 89.45
2023-11-16 17:51:19,878 [ease.py] => Task correct: 81.36759053206555
2023-11-16 17:51:19,879 [ease.py] => Task acc: 91.98867084766336
2023-11-16 17:51:19,907 [trainer.py] => No NME accuracy.
2023-11-16 17:51:19,907 [trainer.py] => CNN: {'total': 79.06, '00-19': 77.07, '20-39': 79.59, '40-59': 77.89, '60-79': 76.71, '80-99': 76.8, '100-119': 82.73, '120-139': 78.21, '140-159': 82.17, 'old': 78.52, 'new': 82.17}
2023-11-16 17:51:19,907 [trainer.py] => CNN top1 curve: [92.6, 87.66, 85.63, 83.59, 81.51, 80.74, 79.83, 79.06]
2023-11-16 17:51:19,907 [trainer.py] => CNN top5 curve: [98.55, 97.05, 95.95, 95.0, 94.14, 93.94, 93.07, 92.66]

2023-11-16 17:51:19,907 [trainer.py] => Average Accuracy (CNN): 83.82750000000001 

2023-11-16 17:51:19,908 [trainer.py] => All params: 87986690
2023-11-16 17:51:19,908 [trainer.py] => Trainable params: 1189632
2023-11-16 17:51:19,918 [ease.py] => Learning on 160-180
2023-11-16 17:53:26,308 [ease.py] => Task 8, Epoch 20/20 => Loss 0.519, Train_accy 86.70
2023-11-16 17:55:17,518 [ease.py] => Task correct: 80.0959232613909
2023-11-16 17:55:17,519 [ease.py] => Task acc: 91.77273565762775
2023-11-16 17:55:17,552 [trainer.py] => No NME accuracy.
2023-11-16 17:55:17,552 [trainer.py] => CNN: {'total': 78.09, '00-19': 75.62, '20-39': 79.43, '40-59': 76.24, '60-79': 75.83, '80-99': 75.36, '100-119': 82.42, '120-139': 77.15, '140-159': 80.93, '160-179': 78.45, 'old': 78.05, 'new': 78.45}
2023-11-16 17:55:17,552 [trainer.py] => CNN top1 curve: [92.6, 87.66, 85.63, 83.59, 81.51, 80.74, 79.83, 79.06, 78.09]
2023-11-16 17:55:17,552 [trainer.py] => CNN top5 curve: [98.55, 97.05, 95.95, 95.0, 94.14, 93.94, 93.07, 92.66, 91.9]

2023-11-16 17:55:17,553 [trainer.py] => Average Accuracy (CNN): 83.19000000000001 

2023-11-16 17:55:17,554 [trainer.py] => All params: 88247810
2023-11-16 17:55:17,555 [trainer.py] => Trainable params: 1189632
2023-11-16 17:55:17,566 [ease.py] => Learning on 180-200
2023-11-16 17:57:41,272 [ease.py] => Task 9, Epoch 20/20 => Loss 0.441, Train_accy 88.55
2023-11-16 17:59:48,930 [ease.py] => Task correct: 78.96666666666667
2023-11-16 17:59:48,931 [ease.py] => Task acc: 91.8
2023-11-16 17:59:48,966 [trainer.py] => No NME accuracy.
2023-11-16 17:59:48,966 [trainer.py] => CNN: {'total': 77.33, '00-19': 75.18, '20-39': 77.53, '40-59': 73.76, '60-79': 75.48, '80-99': 73.72, '100-119': 80.76, '120-139': 76.1, '140-159': 80.38, '160-179': 77.82, '180-199': 81.35, 'old': 76.9, 'new': 81.35}
2023-11-16 17:59:48,966 [trainer.py] => CNN top1 curve: [92.6, 87.66, 85.63, 83.59, 81.51, 80.74, 79.83, 79.06, 78.09, 77.33]
2023-11-16 17:59:48,966 [trainer.py] => CNN top5 curve: [98.55, 97.05, 95.95, 95.0, 94.14, 93.94, 93.07, 92.66, 91.9, 91.52]

2023-11-16 17:59:48,967 [trainer.py] => Average Accuracy (CNN): 82.60400000000001 

