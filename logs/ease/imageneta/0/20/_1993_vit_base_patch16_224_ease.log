2023-11-16 16:14:23,228 [trainer.py] => config: ./exps/ease_ina.json
2023-11-16 16:14:23,229 [trainer.py] => prefix:  
2023-11-16 16:14:23,229 [trainer.py] => dataset: imageneta
2023-11-16 16:14:23,229 [trainer.py] => memory_size: 0
2023-11-16 16:14:23,229 [trainer.py] => memory_per_class: 0
2023-11-16 16:14:23,229 [trainer.py] => fixed_memory: False
2023-11-16 16:14:23,229 [trainer.py] => shuffle: True
2023-11-16 16:14:23,229 [trainer.py] => init_cls: 20
2023-11-16 16:14:23,229 [trainer.py] => increment: 20
2023-11-16 16:14:23,229 [trainer.py] => model_name: ease
2023-11-16 16:14:23,229 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2023-11-16 16:14:23,229 [trainer.py] => device: [device(type='cuda', index=3)]
2023-11-16 16:14:23,229 [trainer.py] => seed: 1993
2023-11-16 16:14:23,229 [trainer.py] => init_epochs: 20
2023-11-16 16:14:23,229 [trainer.py] => init_lr: 0.05
2023-11-16 16:14:23,229 [trainer.py] => later_epochs: 20
2023-11-16 16:14:23,229 [trainer.py] => later_lr: 0.05
2023-11-16 16:14:23,229 [trainer.py] => batch_size: 32
2023-11-16 16:14:23,229 [trainer.py] => weight_decay: 0.005
2023-11-16 16:14:23,229 [trainer.py] => min_lr: 0
2023-11-16 16:14:23,229 [trainer.py] => optimizer: sgd
2023-11-16 16:14:23,229 [trainer.py] => scheduler: cosine
2023-11-16 16:14:23,229 [trainer.py] => pretrained: True
2023-11-16 16:14:23,229 [trainer.py] => vpt_type: Deep
2023-11-16 16:14:23,229 [trainer.py] => prompt_token_num: 5
2023-11-16 16:14:23,230 [trainer.py] => ffn_num: 64
2023-11-16 16:14:23,230 [trainer.py] => solve_method: sim
2023-11-16 16:14:23,230 [trainer.py] => use_diagonal: False
2023-11-16 16:14:23,230 [trainer.py] => recalc_sim: True
2023-11-16 16:14:23,230 [trainer.py] => alpha: 0.1
2023-11-16 16:14:23,230 [trainer.py] => use_init_ptm: False
2023-11-16 16:14:23,230 [trainer.py] => beta: 0
2023-11-16 16:14:23,230 [trainer.py] => use_old_data: False
2023-11-16 16:14:23,230 [trainer.py] => use_reweight: True
2023-11-16 16:14:23,230 [trainer.py] => moni_adam: False
2023-11-16 16:14:23,230 [trainer.py] => adapter_num: -1
2023-11-16 16:14:23,261 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2023-11-16 16:14:26,376 [trainer.py] => All params: 86988288
2023-11-16 16:14:26,377 [trainer.py] => Trainable params: 1189632
2023-11-16 16:14:26,377 [ease.py] => Learning on 0-20
2023-11-16 16:15:22,047 [ease.py] => Task 0, Epoch 20/20 => Loss 0.430, Train_accy 91.06
2023-11-16 16:15:24,885 [ease.py] => Task correct: 100.0
2023-11-16 16:15:24,885 [ease.py] => Task acc: 84.57142857142857
2023-11-16 16:15:24,921 [trainer.py] => No NME accuracy.
2023-11-16 16:15:24,921 [trainer.py] => CNN: {'total': 84.57, '00-19': 84.57, 'old': 0, 'new': 84.57}
2023-11-16 16:15:24,921 [trainer.py] => CNN top1 curve: [84.57]
2023-11-16 16:15:24,921 [trainer.py] => CNN top5 curve: [96.57]

2023-11-16 16:15:24,921 [trainer.py] => Average Accuracy (CNN): 84.57 

2023-11-16 16:15:24,922 [trainer.py] => All params: 87019010
2023-11-16 16:15:24,923 [trainer.py] => Trainable params: 1189632
2023-11-16 16:15:24,925 [ease.py] => Learning on 20-40
2023-11-16 16:16:22,805 [ease.py] => Task 1, Epoch 20/20 => Loss 0.548, Train_accy 86.42
2023-11-16 16:16:28,102 [ease.py] => Task correct: 90.83333333333333
2023-11-16 16:16:28,102 [ease.py] => Task acc: 84.44444444444444
2023-11-16 16:16:28,136 [trainer.py] => No NME accuracy.
2023-11-16 16:16:28,137 [trainer.py] => CNN: {'total': 79.17, '00-19': 76.57, '20-39': 81.62, 'old': 76.57, 'new': 81.62}
2023-11-16 16:16:28,137 [trainer.py] => CNN top1 curve: [84.57, 79.17]
2023-11-16 16:16:28,137 [trainer.py] => CNN top5 curve: [96.57, 95.28]

2023-11-16 16:16:28,137 [trainer.py] => Average Accuracy (CNN): 81.87 

2023-11-16 16:16:28,138 [trainer.py] => All params: 87065090
2023-11-16 16:16:28,139 [trainer.py] => Trainable params: 1189632
2023-11-16 16:16:28,141 [ease.py] => Learning on 40-60
2023-11-16 16:17:11,000 [ease.py] => Task 2, Epoch 20/20 => Loss 0.453, Train_accy 91.39
2023-11-16 16:17:18,284 [ease.py] => Task correct: 82.98319327731092
2023-11-16 16:17:18,285 [ease.py] => Task acc: 84.66386554621849
2023-11-16 16:17:18,314 [trainer.py] => No NME accuracy.
2023-11-16 16:17:18,314 [trainer.py] => CNN: {'total': 74.16, '00-19': 70.86, '20-39': 77.3, '40-59': 74.14, 'old': 74.17, 'new': 74.14}
2023-11-16 16:17:18,314 [trainer.py] => CNN top1 curve: [84.57, 79.17, 74.16]
2023-11-16 16:17:18,314 [trainer.py] => CNN top5 curve: [96.57, 95.28, 94.96]

2023-11-16 16:17:18,314 [trainer.py] => Average Accuracy (CNN): 79.3 

2023-11-16 16:17:18,315 [trainer.py] => All params: 87141890
2023-11-16 16:17:18,316 [trainer.py] => Trainable params: 1189632
2023-11-16 16:17:18,319 [ease.py] => Learning on 60-80
2023-11-16 16:18:16,662 [ease.py] => Task 3, Epoch 20/20 => Loss 0.470, Train_accy 87.76
2023-11-16 16:18:28,906 [ease.py] => Task correct: 77.50716332378224
2023-11-16 16:18:28,906 [ease.py] => Task acc: 86.24641833810888
2023-11-16 16:18:28,926 [trainer.py] => No NME accuracy.
2023-11-16 16:18:28,926 [trainer.py] => CNN: {'total': 71.2, '00-19': 61.71, '20-39': 74.05, '40-59': 68.1, '60-79': 77.93, 'old': 68.07, 'new': 77.93}
2023-11-16 16:18:28,926 [trainer.py] => CNN top1 curve: [84.57, 79.17, 74.16, 71.2]
2023-11-16 16:18:28,926 [trainer.py] => CNN top5 curve: [96.57, 95.28, 94.96, 92.55]

2023-11-16 16:18:28,926 [trainer.py] => Average Accuracy (CNN): 77.275 

2023-11-16 16:18:28,927 [trainer.py] => All params: 87249410
2023-11-16 16:18:28,927 [trainer.py] => Trainable params: 1189632
2023-11-16 16:18:28,931 [ease.py] => Learning on 80-100
2023-11-16 16:19:12,654 [ease.py] => Task 4, Epoch 20/20 => Loss 0.432, Train_accy 90.46
2023-11-16 16:19:27,067 [ease.py] => Task correct: 72.53269916765755
2023-11-16 16:19:27,068 [ease.py] => Task acc: 85.73127229488703
2023-11-16 16:19:27,100 [trainer.py] => No NME accuracy.
2023-11-16 16:19:27,100 [trainer.py] => CNN: {'total': 68.01, '00-19': 57.14, '20-39': 71.35, '40-59': 63.79, '60-79': 76.13, '80-99': 67.83, 'old': 68.05, 'new': 67.83}
2023-11-16 16:19:27,100 [trainer.py] => CNN top1 curve: [84.57, 79.17, 74.16, 71.2, 68.01]
2023-11-16 16:19:27,100 [trainer.py] => CNN top5 curve: [96.57, 95.28, 94.96, 92.55, 90.13]

2023-11-16 16:19:27,100 [trainer.py] => Average Accuracy (CNN): 75.422 

2023-11-16 16:19:27,101 [trainer.py] => All params: 87387650
2023-11-16 16:19:27,101 [trainer.py] => Trainable params: 1189632
2023-11-16 16:19:27,110 [ease.py] => Learning on 100-120
2023-11-16 16:20:10,647 [ease.py] => Task 5, Epoch 20/20 => Loss 0.371, Train_accy 93.12
2023-11-16 16:20:28,778 [ease.py] => Task correct: 71.48717948717949
2023-11-16 16:20:28,779 [ease.py] => Task acc: 86.25641025641026
2023-11-16 16:20:28,800 [trainer.py] => No NME accuracy.
2023-11-16 16:20:28,800 [trainer.py] => CNN: {'total': 67.49, '00-19': 57.14, '20-39': 70.27, '40-59': 62.93, '60-79': 74.32, '80-99': 66.43, '100-119': 70.9, 'old': 66.94, 'new': 70.9}
2023-11-16 16:20:28,800 [trainer.py] => CNN top1 curve: [84.57, 79.17, 74.16, 71.2, 68.01, 67.49]
2023-11-16 16:20:28,800 [trainer.py] => CNN top5 curve: [96.57, 95.28, 94.96, 92.55, 90.13, 88.1]

2023-11-16 16:20:28,800 [trainer.py] => Average Accuracy (CNN): 74.10000000000001 

2023-11-16 16:20:28,801 [trainer.py] => All params: 87556610
2023-11-16 16:20:28,801 [trainer.py] => Trainable params: 1189632
2023-11-16 16:20:28,807 [ease.py] => Learning on 120-140
2023-11-16 16:21:11,824 [ease.py] => Task 6, Epoch 20/20 => Loss 0.534, Train_accy 87.76
2023-11-16 16:21:34,252 [ease.py] => Task correct: 68.064228367529
2023-11-16 16:21:34,252 [ease.py] => Task acc: 85.72702943800178
2023-11-16 16:21:34,279 [trainer.py] => No NME accuracy.
2023-11-16 16:21:34,279 [trainer.py] => CNN: {'total': 64.32, '00-19': 52.57, '20-39': 69.19, '40-59': 61.21, '60-79': 68.47, '80-99': 65.73, '100-119': 70.15, '120-139': 61.64, 'old': 64.72, 'new': 61.64}
2023-11-16 16:21:34,280 [trainer.py] => CNN top1 curve: [84.57, 79.17, 74.16, 71.2, 68.01, 67.49, 64.32]
2023-11-16 16:21:34,280 [trainer.py] => CNN top5 curve: [96.57, 95.28, 94.96, 92.55, 90.13, 88.1, 86.44]

2023-11-16 16:21:34,280 [trainer.py] => Average Accuracy (CNN): 72.70285714285714 

2023-11-16 16:21:34,280 [trainer.py] => All params: 87756290
2023-11-16 16:21:34,281 [trainer.py] => Trainable params: 1189632
2023-11-16 16:21:34,288 [ease.py] => Learning on 140-160
2023-11-16 16:22:18,027 [ease.py] => Task 7, Epoch 20/20 => Loss 0.496, Train_accy 90.96
2023-11-16 16:22:45,316 [ease.py] => Task correct: 65.86538461538461
2023-11-16 16:22:45,317 [ease.py] => Task acc: 85.09615384615384
2023-11-16 16:22:45,344 [trainer.py] => No NME accuracy.
2023-11-16 16:22:45,344 [trainer.py] => CNN: {'total': 62.1, '00-19': 51.43, '20-39': 66.49, '40-59': 61.21, '60-79': 67.57, '80-99': 64.34, '100-119': 68.66, '120-139': 60.96, '140-159': 53.54, 'old': 63.07, 'new': 53.54}
2023-11-16 16:22:45,344 [trainer.py] => CNN top1 curve: [84.57, 79.17, 74.16, 71.2, 68.01, 67.49, 64.32, 62.1]
2023-11-16 16:22:45,344 [trainer.py] => CNN top5 curve: [96.57, 95.28, 94.96, 92.55, 90.13, 88.1, 86.44, 84.38]

2023-11-16 16:22:45,344 [trainer.py] => Average Accuracy (CNN): 71.3775 

2023-11-16 16:22:45,345 [trainer.py] => All params: 87986690
2023-11-16 16:22:45,346 [trainer.py] => Trainable params: 1189632
2023-11-16 16:22:45,356 [ease.py] => Learning on 160-180
2023-11-16 16:23:30,995 [ease.py] => Task 8, Epoch 20/20 => Loss 0.635, Train_accy 86.69
2023-11-16 16:24:04,343 [ease.py] => Task correct: 62.58064516129032
2023-11-16 16:24:04,344 [ease.py] => Task acc: 84.80286738351255
2023-11-16 16:24:04,380 [trainer.py] => No NME accuracy.
2023-11-16 16:24:04,380 [trainer.py] => CNN: {'total': 59.35, '00-19': 48.57, '20-39': 63.24, '40-59': 55.17, '60-79': 67.57, '80-99': 60.84, '100-119': 68.66, '120-139': 60.96, '140-159': 51.97, '160-179': 53.06, 'old': 60.1, 'new': 53.06}
2023-11-16 16:24:04,380 [trainer.py] => CNN top1 curve: [84.57, 79.17, 74.16, 71.2, 68.01, 67.49, 64.32, 62.1, 59.35]
2023-11-16 16:24:04,380 [trainer.py] => CNN top5 curve: [96.57, 95.28, 94.96, 92.55, 90.13, 88.1, 86.44, 84.38, 82.72]

2023-11-16 16:24:04,380 [trainer.py] => Average Accuracy (CNN): 70.0411111111111 

2023-11-16 16:24:04,381 [trainer.py] => All params: 88247810
2023-11-16 16:24:04,382 [trainer.py] => Trainable params: 1189632
2023-11-16 16:24:04,403 [ease.py] => Learning on 180-200
2023-11-16 16:24:48,509 [ease.py] => Task 9, Epoch 20/20 => Loss 0.434, Train_accy 94.12
2023-11-16 16:25:25,695 [ease.py] => Task correct: 61.48782093482554
2023-11-16 16:25:25,696 [ease.py] => Task acc: 84.52929558920343
2023-11-16 16:25:25,724 [trainer.py] => No NME accuracy.
2023-11-16 16:25:25,724 [trainer.py] => CNN: {'total': 58.53, '00-19': 48.57, '20-39': 61.08, '40-59': 55.17, '60-79': 64.86, '80-99': 60.14, '100-119': 66.42, '120-139': 60.96, '140-159': 51.18, '160-179': 51.7, '180-199': 62.9, 'old': 58.14, 'new': 62.9}
2023-11-16 16:25:25,724 [trainer.py] => CNN top1 curve: [84.57, 79.17, 74.16, 71.2, 68.01, 67.49, 64.32, 62.1, 59.35, 58.53]
2023-11-16 16:25:25,724 [trainer.py] => CNN top5 curve: [96.57, 95.28, 94.96, 92.55, 90.13, 88.1, 86.44, 84.38, 82.72, 82.23]

2023-11-16 16:25:25,724 [trainer.py] => Average Accuracy (CNN): 68.89 

