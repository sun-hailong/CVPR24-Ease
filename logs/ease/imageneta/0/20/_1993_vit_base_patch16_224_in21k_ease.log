2023-11-16 16:03:13,672 [trainer.py] => config: ./exps/ease_ina_in21k.json
2023-11-16 16:03:13,672 [trainer.py] => prefix:  
2023-11-16 16:03:13,672 [trainer.py] => dataset: imageneta
2023-11-16 16:03:13,673 [trainer.py] => memory_size: 0
2023-11-16 16:03:13,673 [trainer.py] => memory_per_class: 0
2023-11-16 16:03:13,673 [trainer.py] => fixed_memory: False
2023-11-16 16:03:13,673 [trainer.py] => shuffle: True
2023-11-16 16:03:13,673 [trainer.py] => init_cls: 20
2023-11-16 16:03:13,673 [trainer.py] => increment: 20
2023-11-16 16:03:13,673 [trainer.py] => model_name: ease
2023-11-16 16:03:13,673 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2023-11-16 16:03:13,673 [trainer.py] => device: [device(type='cuda', index=3)]
2023-11-16 16:03:13,673 [trainer.py] => seed: 1993
2023-11-16 16:03:13,673 [trainer.py] => init_epochs: 20
2023-11-16 16:03:13,673 [trainer.py] => init_lr: 0.05
2023-11-16 16:03:13,673 [trainer.py] => later_epochs: 20
2023-11-16 16:03:13,673 [trainer.py] => later_lr: 0.05
2023-11-16 16:03:13,673 [trainer.py] => batch_size: 32
2023-11-16 16:03:13,673 [trainer.py] => weight_decay: 0.005
2023-11-16 16:03:13,673 [trainer.py] => min_lr: 0
2023-11-16 16:03:13,673 [trainer.py] => optimizer: sgd
2023-11-16 16:03:13,673 [trainer.py] => scheduler: cosine
2023-11-16 16:03:13,673 [trainer.py] => pretrained: True
2023-11-16 16:03:13,673 [trainer.py] => vpt_type: Deep
2023-11-16 16:03:13,673 [trainer.py] => prompt_token_num: 5
2023-11-16 16:03:13,673 [trainer.py] => ffn_num: 64
2023-11-16 16:03:13,673 [trainer.py] => solve_method: sim
2023-11-16 16:03:13,673 [trainer.py] => use_diagonal: False
2023-11-16 16:03:13,673 [trainer.py] => recalc_sim: True
2023-11-16 16:03:13,673 [trainer.py] => alpha: 0.1
2023-11-16 16:03:13,673 [trainer.py] => use_init_ptm: False
2023-11-16 16:03:13,674 [trainer.py] => beta: 0
2023-11-16 16:03:13,674 [trainer.py] => use_old_data: False
2023-11-16 16:03:13,674 [trainer.py] => use_reweight: True
2023-11-16 16:03:13,674 [trainer.py] => moni_adam: False
2023-11-16 16:03:13,674 [trainer.py] => adapter_num: -1
2023-11-16 16:03:13,735 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2023-11-16 16:03:17,553 [trainer.py] => All params: 86988288
2023-11-16 16:03:17,554 [trainer.py] => Trainable params: 1189632
2023-11-16 16:03:17,555 [ease.py] => Learning on 0-20
2023-11-16 16:04:13,571 [ease.py] => Task 0, Epoch 20/20 => Loss 0.446, Train_accy 91.49
2023-11-16 16:04:16,365 [ease.py] => Task correct: 100.0
2023-11-16 16:04:16,365 [ease.py] => Task acc: 82.28571428571429
2023-11-16 16:04:16,398 [trainer.py] => No NME accuracy.
2023-11-16 16:04:16,398 [trainer.py] => CNN: {'total': 82.29, '00-19': 82.29, 'old': 0, 'new': 82.29}
2023-11-16 16:04:16,398 [trainer.py] => CNN top1 curve: [82.29]
2023-11-16 16:04:16,398 [trainer.py] => CNN top5 curve: [97.71]

2023-11-16 16:04:16,398 [trainer.py] => Average Accuracy (CNN): 82.29 

2023-11-16 16:04:16,399 [trainer.py] => All params: 87019010
2023-11-16 16:04:16,400 [trainer.py] => Trainable params: 1189632
2023-11-16 16:04:16,401 [ease.py] => Learning on 20-40
2023-11-16 16:05:13,694 [ease.py] => Task 1, Epoch 20/20 => Loss 0.559, Train_accy 87.47
2023-11-16 16:05:19,337 [ease.py] => Task correct: 87.5
2023-11-16 16:05:19,338 [ease.py] => Task acc: 82.5
2023-11-16 16:05:19,377 [trainer.py] => No NME accuracy.
2023-11-16 16:05:19,377 [trainer.py] => CNN: {'total': 75.56, '00-19': 73.14, '20-39': 77.84, 'old': 73.14, 'new': 77.84}
2023-11-16 16:05:19,377 [trainer.py] => CNN top1 curve: [82.29, 75.56]
2023-11-16 16:05:19,377 [trainer.py] => CNN top5 curve: [97.71, 94.72]

2023-11-16 16:05:19,377 [trainer.py] => Average Accuracy (CNN): 78.92500000000001 

2023-11-16 16:05:19,378 [trainer.py] => All params: 87065090
2023-11-16 16:05:19,379 [trainer.py] => Trainable params: 1189632
2023-11-16 16:05:19,382 [ease.py] => Learning on 40-60
2023-11-16 16:06:02,278 [ease.py] => Task 2, Epoch 20/20 => Loss 0.477, Train_accy 91.98
2023-11-16 16:06:09,393 [ease.py] => Task correct: 80.46218487394958
2023-11-16 16:06:09,393 [ease.py] => Task acc: 82.14285714285714
2023-11-16 16:06:09,417 [trainer.py] => No NME accuracy.
2023-11-16 16:06:09,418 [trainer.py] => CNN: {'total': 71.01, '00-19': 69.71, '20-39': 71.35, '40-59': 72.41, 'old': 70.56, 'new': 72.41}
2023-11-16 16:06:09,418 [trainer.py] => CNN top1 curve: [82.29, 75.56, 71.01]
2023-11-16 16:06:09,418 [trainer.py] => CNN top5 curve: [97.71, 94.72, 92.44]

2023-11-16 16:06:09,418 [trainer.py] => Average Accuracy (CNN): 76.28666666666668 

2023-11-16 16:06:09,418 [trainer.py] => All params: 87141890
2023-11-16 16:06:09,419 [trainer.py] => Trainable params: 1189632
2023-11-16 16:06:09,422 [ease.py] => Learning on 60-80
2023-11-16 16:07:08,039 [ease.py] => Task 3, Epoch 20/20 => Loss 0.473, Train_accy 89.16
2023-11-16 16:07:20,350 [ease.py] => Task correct: 73.49570200573066
2023-11-16 16:07:20,350 [ease.py] => Task acc: 84.0974212034384
2023-11-16 16:07:20,397 [trainer.py] => No NME accuracy.
2023-11-16 16:07:20,397 [trainer.py] => CNN: {'total': 67.19, '00-19': 60.57, '20-39': 62.7, '40-59': 63.79, '60-79': 77.93, 'old': 62.18, 'new': 77.93}
2023-11-16 16:07:20,397 [trainer.py] => CNN top1 curve: [82.29, 75.56, 71.01, 67.19]
2023-11-16 16:07:20,397 [trainer.py] => CNN top5 curve: [97.71, 94.72, 92.44, 90.83]

2023-11-16 16:07:20,397 [trainer.py] => Average Accuracy (CNN): 74.0125 

2023-11-16 16:07:20,398 [trainer.py] => All params: 87249410
2023-11-16 16:07:20,399 [trainer.py] => Trainable params: 1189632
2023-11-16 16:07:20,405 [ease.py] => Learning on 80-100
2023-11-16 16:08:04,725 [ease.py] => Task 4, Epoch 20/20 => Loss 0.431, Train_accy 91.98
2023-11-16 16:08:19,235 [ease.py] => Task correct: 70.15457788347206
2023-11-16 16:08:19,236 [ease.py] => Task acc: 83.82877526753865
2023-11-16 16:08:19,265 [trainer.py] => No NME accuracy.
2023-11-16 16:08:19,265 [trainer.py] => CNN: {'total': 65.28, '00-19': 54.29, '20-39': 62.7, '40-59': 60.34, '60-79': 76.58, '80-99': 68.53, 'old': 64.61, 'new': 68.53}
2023-11-16 16:08:19,265 [trainer.py] => CNN top1 curve: [82.29, 75.56, 71.01, 67.19, 65.28]
2023-11-16 16:08:19,265 [trainer.py] => CNN top5 curve: [97.71, 94.72, 92.44, 90.83, 87.99]

2023-11-16 16:08:19,265 [trainer.py] => Average Accuracy (CNN): 72.266 

2023-11-16 16:08:19,266 [trainer.py] => All params: 87387650
2023-11-16 16:08:19,266 [trainer.py] => Trainable params: 1189632
2023-11-16 16:08:19,275 [ease.py] => Learning on 100-120
2023-11-16 16:09:02,496 [ease.py] => Task 5, Epoch 20/20 => Loss 0.396, Train_accy 94.07
2023-11-16 16:09:20,609 [ease.py] => Task correct: 67.48717948717949
2023-11-16 16:09:20,610 [ease.py] => Task acc: 84.2051282051282
2023-11-16 16:09:20,648 [trainer.py] => No NME accuracy.
2023-11-16 16:09:20,648 [trainer.py] => CNN: {'total': 63.59, '00-19': 53.71, '20-39': 58.92, '40-59': 59.48, '60-79': 75.23, '80-99': 66.43, '100-119': 64.18, 'old': 63.5, 'new': 64.18}
2023-11-16 16:09:20,648 [trainer.py] => CNN top1 curve: [82.29, 75.56, 71.01, 67.19, 65.28, 63.59]
2023-11-16 16:09:20,648 [trainer.py] => CNN top5 curve: [97.71, 94.72, 92.44, 90.83, 87.99, 86.46]

2023-11-16 16:09:20,648 [trainer.py] => Average Accuracy (CNN): 70.82000000000001 

2023-11-16 16:09:20,649 [trainer.py] => All params: 87556610
2023-11-16 16:09:20,649 [trainer.py] => Trainable params: 1189632
2023-11-16 16:09:20,656 [ease.py] => Learning on 120-140
2023-11-16 16:10:05,249 [ease.py] => Task 6, Epoch 20/20 => Loss 0.564, Train_accy 88.68
2023-11-16 16:10:27,334 [ease.py] => Task correct: 63.60392506690455
2023-11-16 16:10:27,335 [ease.py] => Task acc: 83.14005352363961
2023-11-16 16:10:27,364 [trainer.py] => No NME accuracy.
2023-11-16 16:10:27,364 [trainer.py] => CNN: {'total': 59.95, '00-19': 48.0, '20-39': 57.3, '40-59': 56.03, '60-79': 69.37, '80-99': 65.73, '100-119': 62.69, '120-139': 58.22, 'old': 60.21, 'new': 58.22}
2023-11-16 16:10:27,364 [trainer.py] => CNN top1 curve: [82.29, 75.56, 71.01, 67.19, 65.28, 63.59, 59.95]
2023-11-16 16:10:27,364 [trainer.py] => CNN top5 curve: [97.71, 94.72, 92.44, 90.83, 87.99, 86.46, 83.76]

2023-11-16 16:10:27,364 [trainer.py] => Average Accuracy (CNN): 69.26714285714287 

2023-11-16 16:10:27,365 [trainer.py] => All params: 87756290
2023-11-16 16:10:27,365 [trainer.py] => Trainable params: 1189632
2023-11-16 16:10:27,373 [ease.py] => Learning on 140-160
2023-11-16 16:11:10,747 [ease.py] => Task 7, Epoch 20/20 => Loss 0.522, Train_accy 91.15
2023-11-16 16:11:37,442 [ease.py] => Task correct: 61.53846153846154
2023-11-16 16:11:37,442 [ease.py] => Task acc: 82.8525641025641
2023-11-16 16:11:37,483 [trainer.py] => No NME accuracy.
2023-11-16 16:11:37,483 [trainer.py] => CNN: {'total': 57.85, '00-19': 46.29, '20-39': 56.22, '40-59': 56.9, '60-79': 68.92, '80-99': 63.64, '100-119': 61.19, '120-139': 56.85, '140-159': 48.82, 'old': 58.88, 'new': 48.82}
2023-11-16 16:11:37,483 [trainer.py] => CNN top1 curve: [82.29, 75.56, 71.01, 67.19, 65.28, 63.59, 59.95, 57.85]
2023-11-16 16:11:37,483 [trainer.py] => CNN top5 curve: [97.71, 94.72, 92.44, 90.83, 87.99, 86.46, 83.76, 82.05]

2023-11-16 16:11:37,483 [trainer.py] => Average Accuracy (CNN): 67.84 

2023-11-16 16:11:37,484 [trainer.py] => All params: 87986690
2023-11-16 16:11:37,485 [trainer.py] => Trainable params: 1189632
2023-11-16 16:11:37,496 [ease.py] => Learning on 160-180
2023-11-16 16:12:24,213 [ease.py] => Task 8, Epoch 20/20 => Loss 0.662, Train_accy 87.74
2023-11-16 16:12:57,494 [ease.py] => Task correct: 58.99641577060932
2023-11-16 16:12:57,494 [ease.py] => Task acc: 82.22222222222223
2023-11-16 16:12:57,521 [trainer.py] => No NME accuracy.
2023-11-16 16:12:57,522 [trainer.py] => CNN: {'total': 55.63, '00-19': 45.14, '20-39': 55.14, '40-59': 52.59, '60-79': 68.02, '80-99': 61.54, '100-119': 61.19, '120-139': 56.85, '140-159': 48.03, '160-179': 46.94, 'old': 56.65, 'new': 46.94}
2023-11-16 16:12:57,522 [trainer.py] => CNN top1 curve: [82.29, 75.56, 71.01, 67.19, 65.28, 63.59, 59.95, 57.85, 55.63]
2023-11-16 16:12:57,522 [trainer.py] => CNN top5 curve: [97.71, 94.72, 92.44, 90.83, 87.99, 86.46, 83.76, 82.05, 79.86]

2023-11-16 16:12:57,522 [trainer.py] => Average Accuracy (CNN): 66.48333333333333 

2023-11-16 16:12:57,522 [trainer.py] => All params: 88247810
2023-11-16 16:12:57,523 [trainer.py] => Trainable params: 1189632
2023-11-16 16:12:57,536 [ease.py] => Learning on 180-200
2023-11-16 16:13:42,047 [ease.py] => Task 9, Epoch 20/20 => Loss 0.446, Train_accy 95.07
2023-11-16 16:14:20,610 [ease.py] => Task correct: 57.99868334430546
2023-11-16 16:14:20,611 [ease.py] => Task acc: 82.02764976958525
2023-11-16 16:14:20,638 [trainer.py] => No NME accuracy.
2023-11-16 16:14:20,638 [trainer.py] => CNN: {'total': 55.04, '00-19': 45.14, '20-39': 54.05, '40-59': 52.59, '60-79': 67.12, '80-99': 60.84, '100-119': 57.46, '120-139': 55.48, '140-159': 48.03, '160-179': 46.94, '180-199': 58.06, 'old': 54.77, 'new': 58.06}
2023-11-16 16:14:20,638 [trainer.py] => CNN top1 curve: [82.29, 75.56, 71.01, 67.19, 65.28, 63.59, 59.95, 57.85, 55.63, 55.04]
2023-11-16 16:14:20,638 [trainer.py] => CNN top5 curve: [97.71, 94.72, 92.44, 90.83, 87.99, 86.46, 83.76, 82.05, 79.86, 78.6]

2023-11-16 16:14:20,639 [trainer.py] => Average Accuracy (CNN): 65.339 

